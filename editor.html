<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Slide Editor</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: #f8fafc;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }

        .editor-container {
            display: grid;
            grid-template-columns: 300px 1fr 400px;
            height: 100vh;
            gap: 1px;
            background: #e2e8f0;
        }

        .sidebar {
            background: white;
            overflow-y: auto;
            border-right: 1px solid #e2e8f0;
        }

        .main-editor {
            background: white;
            overflow-y: auto;
        }

        .preview-panel {
            background: #1f2937;
            overflow: hidden;
            position: relative;
            display: flex;
            flex-direction: column;
        }

        .slide-item {
            padding: 12px;
            border-bottom: 1px solid #e2e8f0;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .slide-item:hover {
            background: #f1f5f9;
        }

        .slide-item.active {
            background: #dbeafe;
            border-left: 3px solid #3b82f6;
        }

        .slide-preview {
            background: #1f2937;
            border-radius: 8px;
            transition: all 0.3s ease;
            overflow: hidden;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
            position: relative;
        }

        .form-group {
            margin-bottom: 16px;
        }

        .form-label {
            display: block;
            margin-bottom: 4px;
            font-weight: 500;
            color: #374151;
        }

        .form-input {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 14px;
        }

        .form-textarea {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 14px;
            resize: vertical;
            min-height: 100px;
        }

        .btn {
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
        }

        .btn-primary {
            background: #3b82f6;
            color: white;
        }

        .btn-primary:hover {
            background: #2563eb;
        }

        .btn-secondary {
            background: #6b7280;
            color: white;
        }

        .btn-secondary:hover {
            background: #4b5563;
        }

        .btn-danger {
            background: #ef4444;
            color: white;
        }

        .btn-danger:hover {
            background: #dc2626;
        }

        .btn-success {
            background: #10b981;
            color: white;
        }

        .btn-success:hover {
            background: #059669;
        }

        .toolbar {
            padding: 16px;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .list-item {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
        }

        .list-item input {
            flex: 1;
        }

        .color-picker {
            width: 40px;
            height: 32px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            cursor: pointer;
        }

        .preview-controls {
            flex-shrink: 0;
        }

        .preview-size-btn {
            padding: 8px;
            border-radius: 6px;
            background: #374151;
            color: #9ca3af;
            border: none;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .preview-size-btn:hover {
            background: #4b5563;
            color: #f3f4f6;
        }

        .preview-size-btn.active {
            background: #3b82f6;
            color: white;
        }

        .preview-container {
            flex: 1;
            overflow: auto;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            background: #111827;
        }

        /* Mobile Preview - 375x667 (iPhone SE) */
        .mobile-preview {
            width: 280px;
            height: 498px;
            border: 8px solid #2d3748;
            border-radius: 24px;
            background: #2d3748;
            box-shadow:
                0 0 0 2px #1a202c,
                0 10px 30px rgba(0, 0, 0, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }

        .mobile-preview::before {
            content: '';
            position: absolute;
            top: -6px;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 6px;
            background: #1a202c;
            border-radius: 3px;
            box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.3);
        }

        .mobile-preview::after {
            content: '';
            position: absolute;
            bottom: -6px;
            left: 50%;
            transform: translateX(-50%);
            width: 50px;
            height: 50px;
            border: 2px solid #1a202c;
            border-radius: 50%;
            background: transparent;
        }

        /* Tablet Preview - 768x1024 (iPad) */
        .tablet-preview {
            width: 384px;
            height: 512px;
            border: 16px solid #2d3748;
            border-radius: 20px;
            background: #2d3748;
            box-shadow:
                0 0 0 2px #1a202c,
                0 15px 40px rgba(0, 0, 0, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }

        .tablet-preview::before {
            content: '';
            position: absolute;
            bottom: -12px;
            left: 50%;
            transform: translateX(-50%);
            width: 50px;
            height: 50px;
            background: transparent;
            border: 3px solid #1a202c;
            border-radius: 50%;
        }

        /* Laptop Preview - 1366x768 */
        .laptop-preview {
            width: 480px;
            height: 270px;
            border: 6px solid #2d3748;
            border-radius: 8px;
            position: relative;
            background: #2d3748;
            box-shadow:
                0 0 0 1px #1a202c,
                0 8px 25px rgba(0, 0, 0, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }

        .laptop-preview::after {
            content: '';
            position: absolute;
            bottom: -25px;
            left: 50%;
            transform: translateX(-50%);
            width: 520px;
            height: 16px;
            background: linear-gradient(to right,
                    #2d3748 0%,
                    #4a5568 20%,
                    #718096 50%,
                    #4a5568 80%,
                    #2d3748 100%);
            border-radius: 0 0 16px 16px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .laptop-preview::before {
            content: '';
            position: absolute;
            bottom: -30px;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 4px;
            background: #1a202c;
            border-radius: 2px;
        }

        /* Fullscreen Preview */
        .fullscreen-preview {
            width: 100%;
            height: 100%;
            max-width: 600px;
            max-height: 400px;
            border: 3px solid #4a5568;
            border-radius: 12px;
            background: #2d3748;
            box-shadow:
                0 0 0 1px #1a202c,
                0 20px 50px rgba(0, 0, 0, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }

        /* Device glow effects on hover */
        .mobile-preview:hover,
        .tablet-preview:hover,
        .laptop-preview:hover,
        .fullscreen-preview:hover {
            box-shadow:
                0 0 0 2px #3b82f6,
                0 0 20px rgba(59, 130, 246, 0.3),
                0 15px 40px rgba(0, 0, 0, 0.4);
        }

        /* Responsive adjustments */
        @media (max-width: 1200px) {
            .mobile-preview {
                width: 240px;
                height: 427px;
            }

            .tablet-preview {
                width: 320px;
                height: 427px;
            }

            .laptop-preview {
                width: 400px;
                height: 225px;
            }
        }
    </style>
</head>

<body>
    <div class="editor-container">
        <!-- Sidebar - Slide List -->
        <div class="sidebar">
            <div class="toolbar">
                <button id="add-slide" class="btn btn-primary">+ Add Slide</button>
            </div>
            <div id="slide-list" class="slide-list">
                <!-- Slides will be populated here -->
            </div>
        </div>

        <!-- Main Editor -->
        <div class="main-editor">
            <div class="toolbar">
                <button id="save-slides" class="btn btn-success">üíæ Save All</button>
                <button id="preview-mode" class="btn btn-secondary">üëÅÔ∏è Preview</button>
                <button id="back-home" class="btn btn-secondary">üè† Home</button>
                <div class="ml-auto">
                    <span id="save-status" class="text-sm text-gray-600"></span>
                </div>
            </div>

            <div id="editor-form" class="p-6">
                <div class="form-group">
                    <label class="form-label">Slide Title</label>
                    <input type="text" id="slide-title" class="form-input" placeholder="Enter slide title">
                </div>

                <!-- Title Typography Controls -->
                <div class="form-group">
                    <label class="form-label">Title Typography</label>
                    <div class="grid grid-cols-2 gap-2">
                        <select id="title-font-family" class="form-input">
                            <option value="">Default Font</option>
                            <option value="Arial, sans-serif">Arial</option>
                            <option value="Georgia, serif">Georgia</option>
                            <option value="'Times New Roman', serif">Times New Roman</option>
                            <option value="'Courier New', monospace">Courier New</option>
                            <option value="Helvetica, sans-serif">Helvetica</option>
                            <option value="Verdana, sans-serif">Verdana</option>
                        </select>
                        <input type="number" id="title-font-size" class="form-input" placeholder="Font Size (px)"
                            min="12" max="120">
                    </div>
                    <div class="grid grid-cols-3 gap-2 mt-2">
                        <select id="title-font-weight" class="form-input">
                            <option value="">Default Weight</option>
                            <option value="300">Light</option>
                            <option value="400">Normal</option>
                            <option value="500">Medium</option>
                            <option value="600">Semi Bold</option>
                            <option value="700">Bold</option>
                            <option value="800">Extra Bold</option>
                        </select>
                        <select id="title-text-align" class="form-input">
                            <option value="">Default Align</option>
                            <option value="left">Left</option>
                            <option value="center">Center</option>
                            <option value="right">Right</option>
                        </select>
                        <input type="color" id="title-color" class="color-picker" title="Title Color">
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Content</label>
                    <textarea id="slide-content" class="form-textarea" placeholder="Enter slide content"></textarea>
                </div>

                <!-- Content Typography Controls -->
                <div class="form-group">
                    <label class="form-label">Content Typography</label>
                    <div class="grid grid-cols-2 gap-2">
                        <select id="content-font-family" class="form-input">
                            <option value="">Default Font</option>
                            <option value="Arial, sans-serif">Arial</option>
                            <option value="Georgia, serif">Georgia</option>
                            <option value="'Times New Roman', serif">Times New Roman</option>
                            <option value="'Courier New', monospace">Courier New</option>
                            <option value="Helvetica, sans-serif">Helvetica</option>
                            <option value="Verdana, sans-serif">Verdana</option>
                        </select>
                        <input type="number" id="content-font-size" class="form-input" placeholder="Font Size (px)"
                            min="12" max="72">
                    </div>
                    <div class="grid grid-cols-3 gap-2 mt-2">
                        <select id="content-font-weight" class="form-input">
                            <option value="">Default Weight</option>
                            <option value="300">Light</option>
                            <option value="400">Normal</option>
                            <option value="500">Medium</option>
                            <option value="600">Semi Bold</option>
                            <option value="700">Bold</option>
                        </select>
                        <select id="content-text-align" class="form-input">
                            <option value="">Default Align</option>
                            <option value="left">Left</option>
                            <option value="center">Center</option>
                            <option value="right">Right</option>
                        </select>
                        <input type="color" id="content-color" class="color-picker" title="Content Color">
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">List Items</label>
                    <div id="list-items">
                        <!-- List items will be added here -->
                    </div>
                    <button type="button" id="add-list-item" class="btn btn-secondary mt-2">+ Add List Item</button>
                </div>

                <!-- List Typography Controls -->
                <div class="form-group">
                    <label class="form-label">List Typography</label>
                    <div class="grid grid-cols-2 gap-2">
                        <select id="list-font-family" class="form-input">
                            <option value="">Default Font</option>
                            <option value="Arial, sans-serif">Arial</option>
                            <option value="Georgia, serif">Georgia</option>
                            <option value="'Times New Roman', serif">Times New Roman</option>
                            <option value="'Courier New', monospace">Courier New</option>
                            <option value="Helvetica, sans-serif">Helvetica</option>
                            <option value="Verdana, sans-serif">Verdana</option>
                        </select>
                        <input type="number" id="list-font-size" class="form-input" placeholder="Font Size (px)"
                            min="12" max="48">
                    </div>
                    <div class="grid grid-cols-3 gap-2 mt-2">
                        <select id="list-font-weight" class="form-input">
                            <option value="">Default Weight</option>
                            <option value="300">Light</option>
                            <option value="400">Normal</option>
                            <option value="500">Medium</option>
                            <option value="600">Semi Bold</option>
                            <option value="700">Bold</option>
                        </select>
                        <select id="list-text-align" class="form-input">
                            <option value="">Default Align</option>
                            <option value="left">Left</option>
                            <option value="center">Center</option>
                            <option value="right">Right</option>
                        </select>
                        <input type="color" id="list-color" class="color-picker" title="List Color">
                    </div>
                </div>

                <div class="grid grid-cols-2 gap-4">
                    <div class="form-group">
                        <label class="form-label">Slide Type</label>
                        <select id="slide-type" class="form-input">
                            <option value="text">Text</option>
                            <option value="image">Image</option>
                            <option value="video">Video</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Background Color</label>
                        <input type="color" id="slide-background" class="color-picker" value="#1f2937">
                    </div>
                </div>

                <!-- Layout Template Selection -->
                <div class="form-group">
                    <label class="form-label">Layout Template</label>
                    <select id="slide-layout" class="form-input">
                        <option value="default">Default - Centered Content</option>
                        <option value="title-only">Title Only - Large Title</option>
                        <option value="title-content">Title + Content - Simple Layout</option>
                        <option value="title-list">Title + List - Focused List</option>
                        <option value="title-media">Title + Media - Media Focus</option>
                        <option value="split-content-media">Split - Content & Media Side by Side</option>
                        <option value="two-column">Two Column - Balanced Layout</option>
                        <option value="center-focus">Center Focus - Compact Center</option>
                        <option value="full-media">Full Media - Media Background</option>
                    </select>
                    <div class="mt-2 p-3 bg-gray-50 rounded text-sm text-gray-600">
                        <div id="layout-description">Choose a layout template to organize your slide content</div>
                    </div>
                </div>

                <div id="media-section" class="form-group" style="display: none;">
                    <label class="form-label">Media</label>

                    <!-- Upload Area -->
                    <div id="upload-area"
                        class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center mb-4 transition-colors hover:border-blue-400">
                        <div id="upload-content">
                            <svg class="w-12 h-12 mx-auto mb-4 text-gray-400" fill="none" stroke="currentColor"
                                viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12">
                                </path>
                            </svg>
                            <p class="text-gray-600 mb-2">Drag & drop files here or click to browse</p>
                            <p class="text-sm text-gray-400">Supports: JPG, PNG, GIF, WebP, MP4, WebM, MOV</p>
                            <input type="file" id="file-input" class="hidden" accept="image/*,video/*">
                            <button type="button" id="browse-btn" class="btn btn-secondary mt-2">Browse Files</button>
                        </div>
                        <div id="upload-progress" class="hidden">
                            <div class="w-full bg-gray-200 rounded-full h-2 mb-2">
                                <div id="progress-bar" class="bg-blue-600 h-2 rounded-full transition-all duration-300"
                                    style="width: 0%"></div>
                            </div>
                            <p id="upload-status" class="text-sm text-gray-600">Uploading...</p>
                        </div>
                    </div>

                    <!-- Manual URL Input -->
                    <div class="mb-4">
                        <label class="form-label">Or enter URL manually</label>
                        <input type="url" id="media-url" class="form-input" placeholder="Enter image or video URL">
                    </div>

                    <div id="media-options" style="display: none;">
                        <label class="form-label mt-2">Alt Text / Poster URL</label>
                        <input type="text" id="media-alt" class="form-input" placeholder="Alt text or poster URL">
                    </div>
                </div>

                <div class="flex gap-2 mt-6">
                    <button id="update-slide" class="btn btn-primary">Update Slide</button>
                    <button id="delete-slide" class="btn btn-danger">Delete Slide</button>
                </div>
            </div>
        </div>

        <!-- Preview Panel -->
        <div class="preview-panel">
            <!-- Preview Controls -->
            <div class="preview-controls bg-gray-800 p-3 border-b border-gray-700">
                <div class="flex items-center justify-between">
                    <h3 class="text-white font-medium">Preview</h3>
                    <div class="flex items-center gap-2">
                        <button id="preview-mobile" class="preview-size-btn active" data-size="mobile"
                            title="Mobile (375x667)">
                            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd"
                                    d="M7 2a2 2 0 00-2 2v12a2 2 0 002 2h6a2 2 0 002-2V4a2 2 0 00-2-2H7zM6 4a1 1 0 011-1h6a1 1 0 011 1v12a1 1 0 01-1 1H7a1 1 0 01-1-1V4z"
                                    clip-rule="evenodd"></path>
                            </svg>
                        </button>
                        <button id="preview-tablet" class="preview-size-btn" data-size="tablet"
                            title="Tablet (768x1024)">
                            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd"
                                    d="M3 4a2 2 0 012-2h10a2 2 0 012 2v12a2 2 0 01-2 2H5a2 2 0 01-2-2V4zm2-1a1 1 0 00-1 1v12a1 1 0 001 1h10a1 1 0 001-1V4a1 1 0 00-1-1H5z"
                                    clip-rule="evenodd"></path>
                            </svg>
                        </button>
                        <button id="preview-laptop" class="preview-size-btn" data-size="laptop"
                            title="Laptop (1366x768)">
                            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd"
                                    d="M3 5a2 2 0 012-2h10a2 2 0 012 2v8a2 2 0 01-2 2h-2.22l.123.489A.5.5 0 0112.4 16H7.6a.5.5 0 01-.501-.511L7.22 15H5a2 2 0 01-2-2V5zm2-1a1 1 0 00-1 1v8a1 1 0 001 1h10a1 1 0 001-1V5a1 1 0 00-1-1H5z"
                                    clip-rule="evenodd"></path>
                            </svg>
                        </button>
                        <button id="preview-fullscreen" class="preview-size-btn" data-size="fullscreen"
                            title="Full Size">
                            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd"
                                    d="M3 4a1 1 0 011-1h4a1 1 0 010 2H6.414l2.293 2.293a1 1 0 11-1.414 1.414L5 6.414V8a1 1 0 01-2 0V4zm9 1a1 1 0 010-2h4a1 1 0 011 1v4a1 1 0 01-2 0V6.414l-2.293 2.293a1 1 0 11-1.414-1.414L13.586 5H12zm-9 7a1 1 0 012 0v1.586l2.293-2.293a1 1 0 111.414 1.414L6.414 15H8a1 1 0 010 2H4a1 1 0 01-1-1v-4zm13-1a1 1 0 011 1v4a1 1 0 01-1 1h-4a1 1 0 010-2h1.586l-2.293-2.293a1 1 0 111.414-1.414L15 13.586V12a1 1 0 011-1z"
                                    clip-rule="evenodd"></path>
                            </svg>
                        </button>
                        <div class="w-px h-6 bg-gray-600 mx-1"></div>
                        <button id="zoom-out" class="preview-size-btn" title="Zoom Out">
                            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd"
                                    d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z"
                                    clip-rule="evenodd"></path>
                                <path fill-rule="evenodd" d="M5 8a1 1 0 011-1h4a1 1 0 110 2H6a1 1 0 01-1-1z"
                                    clip-rule="evenodd"></path>
                            </svg>
                        </button>
                        <button id="zoom-in" class="preview-size-btn" title="Zoom In">
                            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd"
                                    d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z"
                                    clip-rule="evenodd"></path>
                                <path fill-rule="evenodd"
                                    d="M8 6a1 1 0 011 1v1h1a1 1 0 110 2H9v1a1 1 0 11-2 0v-1H6a1 1 0 110-2h1V7a1 1 0 011-1z"
                                    clip-rule="evenodd"></path>
                            </svg>
                        </button>
                        <div class="w-px h-6 bg-gray-600 mx-1"></div>
                        <button id="test-preview" class="preview-size-btn" title="Test Mode - No Scaling">
                            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd"
                                    d="M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"
                                    clip-rule="evenodd"></path>
                            </svg>
                        </button>
                    </div>
                </div>
                <div class="mt-2 flex items-center justify-between text-xs text-gray-400">
                    <span id="preview-dimensions">375 √ó 667 px</span>
                    <span id="zoom-level">100%</span>
                </div>
                <div class="mt-1 text-xs text-gray-500 text-center">
                    <span title="Keyboard shortcuts: 1-4 for device sizes, +/- for zoom, 0 to reset zoom">‚å®Ô∏è Shortcuts:
                        1-4, +/-, 0</span>
                </div>
            </div>

            <!-- Preview Container -->
            <div id="preview-container" class="preview-container">
                <div id="slide-preview" class="slide-preview mobile-preview">
                    <div style="
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        height: 100%;
                        color: white;
                        text-align: center;
                        padding: 20px;
                    ">
                        <div>
                            <h2 class="text-xl mb-4">Slide Preview</h2>
                            <p class="text-gray-300">Select a slide to preview</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script type="module">
        import { SlideRenderer } from '/static/slide-renderer.js';

        let slides = [];
        let config = {};
        let currentSlideIndex = -1;
        const slideRenderer = new SlideRenderer();

        // DOM elements
        const slideList = document.getElementById('slide-list');
        const slideTitle = document.getElementById('slide-title');
        const slideContent = document.getElementById('slide-content');
        const slideType = document.getElementById('slide-type');
        const slideBackground = document.getElementById('slide-background');
        const mediaUrl = document.getElementById('media-url');
        const mediaAlt = document.getElementById('media-alt');
        const mediaSection = document.getElementById('media-section');
        const mediaOptions = document.getElementById('media-options');
        const listItems = document.getElementById('list-items');
        const slidePreview = document.getElementById('slide-preview');
        const saveStatus = document.getElementById('save-status');

        // Typography controls
        const titleFontFamily = document.getElementById('title-font-family');
        const titleFontSize = document.getElementById('title-font-size');
        const titleFontWeight = document.getElementById('title-font-weight');
        const titleTextAlign = document.getElementById('title-text-align');
        const titleColor = document.getElementById('title-color');
        const contentFontFamily = document.getElementById('content-font-family');
        const contentFontSize = document.getElementById('content-font-size');
        const contentFontWeight = document.getElementById('content-font-weight');
        const contentTextAlign = document.getElementById('content-text-align');
        const contentColor = document.getElementById('content-color');
        const listFontFamily = document.getElementById('list-font-family');
        const listFontSize = document.getElementById('list-font-size');
        const listFontWeight = document.getElementById('list-font-weight');
        const listTextAlign = document.getElementById('list-text-align');
        const listColor = document.getElementById('list-color');

        // Layout controls
        const slideLayout = document.getElementById('slide-layout');
        const layoutDescription = document.getElementById('layout-description');

        // Upload elements
        const uploadArea = document.getElementById('upload-area');
        const uploadContent = document.getElementById('upload-content');
        const uploadProgress = document.getElementById('upload-progress');
        const progressBar = document.getElementById('progress-bar');
        const uploadStatus = document.getElementById('upload-status');
        const fileInput = document.getElementById('file-input');
        const browseBtn = document.getElementById('browse-btn');

        // Preview controls
        const previewContainer = document.getElementById('preview-container');
        const previewDimensions = document.getElementById('preview-dimensions');
        const previewSizeBtns = document.querySelectorAll('.preview-size-btn');

        // Preview size configurations
        const previewSizes = {
            mobile: {
                class: 'mobile-preview',
                dimensions: '375 √ó 667 px',
                description: 'Mobile Phone'
            },
            tablet: {
                class: 'tablet-preview',
                dimensions: '768 √ó 1024 px',
                description: 'Tablet'
            },
            laptop: {
                class: 'laptop-preview',
                dimensions: '1366 √ó 768 px',
                description: 'Laptop'
            },
            fullscreen: {
                class: 'fullscreen-preview',
                dimensions: 'Full Size',
                description: 'Full Screen'
            }
        };

        let currentPreviewSize = 'mobile';
        let currentZoom = 1.0;
        let testMode = false;
        const minZoom = 0.5;
        const maxZoom = 2.0;
        const zoomStep = 0.1;

        // Layout descriptions
        const layoutDescriptions = {
            'default': 'Standard centered layout with title, content, list, and media stacked vertically',
            'title-only': 'Large title only - perfect for section breaks or simple announcements',
            'title-content': 'Title and content only - clean and simple for text-heavy slides',
            'title-list': 'Title with focused list presentation - great for bullet points',
            'title-media': 'Title with large media focus - ideal for image or video presentations',
            'split-content-media': 'Content and media side by side - balanced information display',
            'two-column': 'Two column layout - perfect for comparisons or structured content',
            'center-focus': 'Compact centered layout - all content tightly grouped',
            'full-media': 'Full-screen media with overlay title - dramatic visual impact'
        };

        // Load slides on page load
        async function loadSlides() {
            try {
                console.log('Loading slides...');
                const response = await fetch('/api/slides');
                const data = await response.json();
                slides = data.slides || [];
                config = data.config || {};

                console.log('Loaded slides:', slides.length);

                // Update slideRenderer with the loaded slides
                slideRenderer.slides = slides;
                slideRenderer.config = config;

                renderSlideList();
                if (slides.length > 0) {
                    selectSlide(0);
                } else {
                    // If no slides, show empty state
                    updatePreview();
                }
            } catch (error) {
                console.error('Error loading slides:', error);
                showStatus('Error loading slides', 'error');
                // Show error state in preview
                slidePreview.innerHTML = `
                    <div style="
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        height: 100%;
                        color: #ef4444;
                        text-align: center;
                        padding: 20px;
                    ">
                        <div>
                            <h2 class="text-xl mb-4">Error Loading Slides</h2>
                            <p class="text-gray-300">Please check the console for details</p>
                        </div>
                    </div>
                `;
            }
        }

        // Render slide list in sidebar
        function renderSlideList() {
            slideList.innerHTML = '';
            slides.forEach((slide, index) => {
                const slideItem = document.createElement('div');
                slideItem.className = `slide-item ${index === currentSlideIndex ? 'active' : ''}`;
                slideItem.innerHTML = `
                    <div class="font-medium text-sm">${slide.title || `Slide ${index + 1}`}</div>
                    <div class="text-xs text-gray-500 mt-1">${slide.type || 'text'}</div>
                `;
                slideItem.addEventListener('click', () => selectSlide(index));
                slideList.appendChild(slideItem);
            });
        }

        // Select a slide for editing
        function selectSlide(index) {
            console.log('Selecting slide:', index, 'Total slides:', slides.length);

            if (index < 0 || index >= slides.length) {
                console.log('Invalid slide index');
                return;
            }

            currentSlideIndex = index;
            const slide = slides[index];

            console.log('Selected slide:', slide);

            // Update form
            slideTitle.value = slide.title || '';
            slideContent.value = slide.content || '';
            slideType.value = slide.type || 'text';
            slideBackground.value = slide.background || '#1f2937';
            slideLayout.value = slide.layout || 'default';

            // Update typography controls
            updateTypographyControls(slide);

            // Update layout description
            updateLayoutDescription();

            // Handle media
            if (slide.media) {
                mediaUrl.value = slide.media.src || '';
                mediaAlt.value = slide.media.alt || slide.media.poster || '';
            } else {
                mediaUrl.value = '';
                mediaAlt.value = '';
            }

            // Handle list items
            renderListItems(slide.list || []);

            // Update UI
            updateMediaSection();
            renderSlideList();
            updatePreview();
        }

        // Update typography controls based on slide data
        function updateTypographyControls(slide) {
            // Title typography
            if (slide.titleStyle) {
                titleFontFamily.value = slide.titleStyle.fontFamily || '';
                titleFontSize.value = slide.titleStyle.fontSize ? parseInt(slide.titleStyle.fontSize) : '';
                titleFontWeight.value = slide.titleStyle.fontWeight || '';
                titleTextAlign.value = slide.titleStyle.textAlign || '';
                titleColor.value = slide.titleStyle.color || '#ffffff';
            } else {
                titleFontFamily.value = '';
                titleFontSize.value = '';
                titleFontWeight.value = '';
                titleTextAlign.value = '';
                titleColor.value = '#ffffff';
            }

            // Content typography
            if (slide.contentStyle) {
                contentFontFamily.value = slide.contentStyle.fontFamily || '';
                contentFontSize.value = slide.contentStyle.fontSize ? parseInt(slide.contentStyle.fontSize) : '';
                contentFontWeight.value = slide.contentStyle.fontWeight || '';
                contentTextAlign.value = slide.contentStyle.textAlign || '';
                contentColor.value = slide.contentStyle.color || '#f3f4f6';
            } else {
                contentFontFamily.value = '';
                contentFontSize.value = '';
                contentFontWeight.value = '';
                contentTextAlign.value = '';
                contentColor.value = '#f3f4f6';
            }

            // List typography
            if (slide.listStyle) {
                listFontFamily.value = slide.listStyle.fontFamily || '';
                listFontSize.value = slide.listStyle.fontSize ? parseInt(slide.listStyle.fontSize) : '';
                listFontWeight.value = slide.listStyle.fontWeight || '';
                listTextAlign.value = slide.listStyle.textAlign || '';
                listColor.value = slide.listStyle.color || '#f3f4f6';
            } else {
                listFontFamily.value = '';
                listFontSize.value = '';
                listFontWeight.value = '';
                listTextAlign.value = '';
                listColor.value = '#f3f4f6';
            }
        }

        // Get typography styles from controls
        function getTypographyStyles() {
            const titleStyle = {};
            const contentStyle = {};
            const listStyle = {};

            // Title styles
            if (titleFontFamily.value) titleStyle.fontFamily = titleFontFamily.value;
            if (titleFontSize.value) titleStyle.fontSize = titleFontSize.value + 'px';
            if (titleFontWeight.value) titleStyle.fontWeight = titleFontWeight.value;
            if (titleTextAlign.value) titleStyle.textAlign = titleTextAlign.value;
            if (titleColor.value && titleColor.value !== '#ffffff') titleStyle.color = titleColor.value;

            // Content styles
            if (contentFontFamily.value) contentStyle.fontFamily = contentFontFamily.value;
            if (contentFontSize.value) contentStyle.fontSize = contentFontSize.value + 'px';
            if (contentFontWeight.value) contentStyle.fontWeight = contentFontWeight.value;
            if (contentTextAlign.value) contentStyle.textAlign = contentTextAlign.value;
            if (contentColor.value && contentColor.value !== '#f3f4f6') contentStyle.color = contentColor.value;

            // List styles
            if (listFontFamily.value) listStyle.fontFamily = listFontFamily.value;
            if (listFontSize.value) listStyle.fontSize = listFontSize.value + 'px';
            if (listFontWeight.value) listStyle.fontWeight = listFontWeight.value;
            if (listTextAlign.value) listStyle.textAlign = listTextAlign.value;
            if (listColor.value && listColor.value !== '#f3f4f6') listStyle.color = listColor.value;

            return {
                titleStyle: Object.keys(titleStyle).length > 0 ? titleStyle : null,
                contentStyle: Object.keys(contentStyle).length > 0 ? contentStyle : null,
                listStyle: Object.keys(listStyle).length > 0 ? listStyle : null
            };
        }

        // Render list items
        function renderListItems(items) {
            listItems.innerHTML = '';
            items.forEach((item, index) => {
                addListItemElement(item, index);
            });
        }

        // Add list item element
        function addListItemElement(value = '', index = -1) {
            const listItem = document.createElement('div');
            listItem.className = 'list-item';
            listItem.innerHTML = `
                <input type="text" class="form-input" value="${value}" placeholder="List item">
                <button type="button" class="btn btn-danger" onclick="this.parentElement.remove()">√ó</button>
            `;
            listItems.appendChild(listItem);
        }

        // Update media section visibility
        function updateMediaSection() {
            const type = slideType.value;
            mediaSection.style.display = (type === 'image' || type === 'video') ? 'block' : 'none';
            mediaOptions.style.display = type === 'video' ? 'block' : 'none';
        }

        // Update slide preview with responsive scaling
        function updatePreview() {
            if (currentSlideIndex < 0 || !slides[currentSlideIndex]) {
                slidePreview.innerHTML = `
                    <div style="
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        height: 100%;
                        color: white;
                        text-align: center;
                        padding: 20px;
                    ">
                        <div>
                            <h2 class="text-xl mb-4">Slide Preview</h2>
                            <p class="text-gray-300">Select a slide to preview</p>
                        </div>
                    </div>
                `;
                return;
            }

            const slide = slides[currentSlideIndex];
            slidePreview.style.background = slide.background || '#1f2937';

            // Update slideRenderer with current slides before rendering
            slideRenderer.slides = slides;
            slideRenderer.config = config;

            // Get the rendered slide content
            const renderedContent = slideRenderer.renderSlide(currentSlideIndex, false);

            console.log('Rendered content length:', renderedContent ? renderedContent.length : 0);
            console.log('Rendered content preview:', renderedContent ? renderedContent.substring(0, 200) + '...' : 'null');

            // If no content is rendered, show a simple fallback
            if (!renderedContent || renderedContent.trim() === '') {
                slidePreview.innerHTML = `
                    <div style="
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        height: 100%;
                        color: white;
                        text-align: center;
                        padding: 20px;
                    ">
                        <div>
                            <h2 class="text-xl mb-4">${slide.title || 'Untitled Slide'}</h2>
                            <p class="text-gray-300">${slide.content || 'No content'}</p>
                            <p class="text-xs text-gray-500 mt-4">Type: ${slide.type} | Background: ${slide.background}</p>
                        </div>
                    </div>
                `;
                return;
            }

            // Apply responsive scaling based on preview size
            const scaledContent = applyResponsiveScaling(renderedContent);

            slidePreview.innerHTML = scaledContent;
        }

        // Apply responsive scaling to slide content
        function applyResponsiveScaling(content) {
            // If content is empty or invalid, return a placeholder
            if (!content || content.trim() === '') {
                return `
                    <div style="
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        height: 100%;
                        color: #9ca3af;
                        text-align: center;
                        padding: 20px;
                    ">
                        <div>
                            <h3>No Content</h3>
                            <p>This slide appears to be empty</p>
                        </div>
                    </div>
                `;
            }

            // Test mode - show content without scaling
            if (testMode) {
                return `
                    <div style="
                        width: 100%;
                        height: 100%;
                        overflow: auto;
                        padding: 10px;
                        font-size: 12px;
                        background: rgba(0,0,0,0.1);
                        border: 1px solid #4a5568;
                    ">
                        <div style="color: #e2e8f0; font-family: monospace; white-space: pre-wrap;">
                            ${content.replace(/</g, '&lt;').replace(/>/g, '&gt;')}
                        </div>
                    </div>
                `;
            }

            const scaleFactors = {
                mobile: 1,
                tablet: 1.02,
                laptop: 0.99,
                fullscreen: 0.96
            };

            const baseScale = scaleFactors[currentPreviewSize] || 0.6;
            const finalScale = baseScale * currentZoom;

            // Ensure scale is reasonable
            const clampedScale = Math.max(0.1, Math.min(2.0, finalScale));

            return `
                <div style="
                    transform: scale(${clampedScale});
                    transform-origin: center center;
                    width: ${100 / clampedScale}%;
                    height: ${100 / clampedScale}%;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    overflow: hidden;
                ">
                    ${content}
                </div>
            `;
        }

        // Add new slide
        function addSlide() {
            const newSlide = {
                id: slides.length,
                type: 'text',
                background: '#1f2937',
                title: `Slide ${slides.length + 1}`,
                content: '',
                list: null,
                media: null
            };

            slides.push(newSlide);

            // Update slideRenderer with current slides
            slideRenderer.slides = slides;
            slideRenderer.config = config;

            renderSlideList();
            selectSlide(slides.length - 1);
        }

        // Update current slide
        function updateSlide() {
            if (currentSlideIndex < 0) return;

            const slide = slides[currentSlideIndex];
            slide.title = slideTitle.value;
            slide.content = slideContent.value;
            slide.type = slideType.value;
            slide.background = slideBackground.value;
            slide.layout = slideLayout.value;

            // Apply typography styles
            const { titleStyle, contentStyle, listStyle } = getTypographyStyles();
            slide.titleStyle = titleStyle;
            slide.contentStyle = contentStyle;
            slide.listStyle = listStyle;

            // Handle list items
            const listInputs = listItems.querySelectorAll('input');
            const listValues = Array.from(listInputs).map(input => input.value).filter(value => value.trim());
            slide.list = listValues.length > 0 ? listValues : null;

            // Handle media
            if (slideType.value === 'image' || slideType.value === 'video') {
                if (mediaUrl.value) {
                    slide.media = {
                        type: slideType.value,
                        src: mediaUrl.value,
                        alt: mediaAlt.value || 'Media',
                        controls: slideType.value === 'video',
                        poster: slideType.value === 'video' ? mediaAlt.value : null
                    };
                } else {
                    slide.media = null;
                }
            } else {
                slide.media = null;
            }

            // Update slideRenderer with current slides
            slideRenderer.slides = slides;
            slideRenderer.config = config;

            renderSlideList();
            updatePreview();
            showStatus('Slide updated', 'success');
        }

        // Delete current slide
        function deleteSlide() {
            if (currentSlideIndex < 0) return;

            if (confirm('Are you sure you want to delete this slide?')) {
                slides.splice(currentSlideIndex, 1);

                // Update slide IDs
                slides.forEach((slide, index) => {
                    slide.id = index;
                });

                // Update slideRenderer with current slides
                slideRenderer.slides = slides;
                slideRenderer.config = config;

                renderSlideList();

                if (slides.length > 0) {
                    selectSlide(Math.min(currentSlideIndex, slides.length - 1));
                } else {
                    currentSlideIndex = -1;
                    slidePreview.innerHTML = '<div class="text-center"><h2 class="text-xl mb-4">No Slides</h2><p class="text-gray-300">Add a slide to get started</p></div>';
                }

                showStatus('Slide deleted', 'success');
            }
        }

        // Save all slides
        async function saveSlides() {
            try {
                showStatus('Saving...', 'info');

                const response = await fetch('/api/slides', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ slides, config })
                });

                const result = await response.json();

                if (response.ok) {
                    showStatus('Slides saved successfully!', 'success');
                } else {
                    showStatus(`Error: ${result.error}`, 'error');
                }
            } catch (error) {
                console.error('Error saving slides:', error);
                showStatus('Error saving slides', 'error');
            }
        }

        // Show status message
        function showStatus(message, type) {
            saveStatus.textContent = message;
            saveStatus.className = `text-sm ${type === 'error' ? 'text-red-600' : type === 'success' ? 'text-green-600' : 'text-blue-600'}`;

            if (type === 'success' || type === 'error') {
                setTimeout(() => {
                    saveStatus.textContent = '';
                }, 3000);
            }
        }

        // File upload functionality
        function setupFileUpload() {
            // Drag and drop
            uploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadArea.classList.add('border-blue-400', 'bg-blue-50');
            });

            uploadArea.addEventListener('dragleave', (e) => {
                e.preventDefault();
                uploadArea.classList.remove('border-blue-400', 'bg-blue-50');
            });

            uploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadArea.classList.remove('border-blue-400', 'bg-blue-50');
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    handleFileUpload(files[0]);
                }
            });

            // Click to browse
            browseBtn.addEventListener('click', () => {
                fileInput.click();
            });

            uploadArea.addEventListener('click', (e) => {
                if (e.target === uploadArea || e.target.closest('#upload-content')) {
                    fileInput.click();
                }
            });

            fileInput.addEventListener('change', (e) => {
                if (e.target.files.length > 0) {
                    handleFileUpload(e.target.files[0]);
                }
            });
        }

        async function handleFileUpload(file) {
            // Validate file type
            const allowedTypes = ['image/jpeg', 'image/jpg', 'image/png', 'image/gif', 'image/webp', 'video/mp4', 'video/webm', 'video/quicktime'];
            if (!allowedTypes.includes(file.type)) {
                showStatus('Invalid file type. Please upload an image or video.', 'error');
                return;
            }

            // Show progress
            uploadContent.classList.add('hidden');
            uploadProgress.classList.remove('hidden');
            progressBar.style.width = '0%';
            uploadStatus.textContent = 'Uploading...';

            try {
                const formData = new FormData();
                formData.append('file', file);

                const response = await fetch('/api/upload', {
                    method: 'POST',
                    body: formData
                });

                if (!response.ok) {
                    throw new Error('Upload failed');
                }

                const result = await response.json();

                // Update progress to 100%
                progressBar.style.width = '100%';
                uploadStatus.textContent = 'Upload complete!';

                // Update media URL
                mediaUrl.value = result.path;

                // Update slide type if needed
                if (result.type === 'video' && slideType.value !== 'video') {
                    slideType.value = 'video';
                    updateMediaSection();
                } else if (result.type === 'image' && slideType.value !== 'image') {
                    slideType.value = 'image';
                    updateMediaSection();
                }

                // Update the slide
                updateSlide();

                showStatus(`File uploaded successfully: ${result.filename}`, 'success');

                // Reset upload area after delay
                setTimeout(() => {
                    uploadContent.classList.remove('hidden');
                    uploadProgress.classList.add('hidden');
                    fileInput.value = '';
                }, 2000);

            } catch (error) {
                console.error('Upload error:', error);
                showStatus('Upload failed. Please try again.', 'error');

                // Reset upload area
                uploadContent.classList.remove('hidden');
                uploadProgress.classList.add('hidden');
                fileInput.value = '';
            }
        }

        // Update layout description
        function updateLayoutDescription() {
            const layout = slideLayout.value;
            layoutDescription.textContent = layoutDescriptions[layout] || 'Choose a layout template to organize your slide content';
        }

        // Setup preview size controls
        function setupPreviewControls() {
            previewSizeBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    const size = btn.dataset.size;
                    setPreviewSize(size);
                });
            });
        }

        // Setup zoom controls
        function setupZoomControls() {
            const zoomInBtn = document.getElementById('zoom-in');
            const zoomOutBtn = document.getElementById('zoom-out');

            zoomInBtn.addEventListener('click', () => {
                if (currentZoom < maxZoom) {
                    currentZoom = Math.min(maxZoom, currentZoom + zoomStep);
                    updateZoomDisplay();
                    updatePreview();
                }
            });

            zoomOutBtn.addEventListener('click', () => {
                if (currentZoom > minZoom) {
                    currentZoom = Math.max(minZoom, currentZoom - zoomStep);
                    updateZoomDisplay();
                    updatePreview();
                }
            });

            // Test mode button
            const testBtn = document.getElementById('test-preview');
            if (testBtn) {
                testBtn.addEventListener('click', () => {
                    testMode = !testMode;
                    testBtn.classList.toggle('active', testMode);
                    console.log('Test mode:', testMode);
                    updatePreview();
                });
            }

            // Keyboard shortcuts for preview controls
            document.addEventListener('keydown', (e) => {
                // Only handle shortcuts when not typing in input fields
                if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA' || e.target.tagName === 'SELECT') {
                    return;
                }

                switch (e.key) {
                    case '1':
                        e.preventDefault();
                        setPreviewSize('mobile');
                        break;
                    case '2':
                        e.preventDefault();
                        setPreviewSize('tablet');
                        break;
                    case '3':
                        e.preventDefault();
                        setPreviewSize('laptop');
                        break;
                    case '4':
                        e.preventDefault();
                        setPreviewSize('fullscreen');
                        break;
                    case '=':
                    case '+':
                        e.preventDefault();
                        if (currentZoom < maxZoom) {
                            currentZoom = Math.min(maxZoom, currentZoom + zoomStep);
                            updateZoomDisplay();
                            updatePreview();
                        }
                        break;
                    case '-':
                        e.preventDefault();
                        if (currentZoom > minZoom) {
                            currentZoom = Math.max(minZoom, currentZoom - zoomStep);
                            updateZoomDisplay();
                            updatePreview();
                        }
                        break;
                    case '0':
                        e.preventDefault();
                        currentZoom = 1.0;
                        updateZoomDisplay();
                        updatePreview();
                        break;
                }
            });
        }

        // Update zoom level display
        function updateZoomDisplay() {
            const zoomLevel = document.getElementById('zoom-level');
            zoomLevel.textContent = Math.round(currentZoom * 100) + '%';
        }

        // Set preview size
        function setPreviewSize(size) {
            if (!previewSizes[size]) return;

            currentPreviewSize = size;
            const config = previewSizes[size];

            // Reset zoom when changing device size
            currentZoom = 1.0;
            updateZoomDisplay();

            // Update active button
            previewSizeBtns.forEach(btn => {
                btn.classList.toggle('active', btn.dataset.size === size);
            });

            // Update preview container classes
            slidePreview.className = `slide-preview ${config.class}`;

            // Update dimensions display
            previewDimensions.textContent = config.dimensions;

            // Force re-render of current slide to fit new size
            if (currentSlideIndex >= 0) {
                updatePreview();
            }
        }

        // Event listeners
        document.getElementById('add-slide').addEventListener('click', addSlide);
        document.getElementById('update-slide').addEventListener('click', updateSlide);
        document.getElementById('delete-slide').addEventListener('click', deleteSlide);
        document.getElementById('save-slides').addEventListener('click', saveSlides);
        document.getElementById('add-list-item').addEventListener('click', () => addListItemElement());
        document.getElementById('preview-mode').addEventListener('click', () => window.open('/reader', '_blank'));
        document.getElementById('back-home').addEventListener('click', () => window.location.href = '/');

        slideType.addEventListener('change', updateMediaSection);
        slideLayout.addEventListener('change', () => {
            updateLayoutDescription();
            if (currentSlideIndex >= 0) {
                updateSlide();
            }
        });

        // Typography event listeners
        [titleFontFamily, titleFontSize, titleFontWeight, titleTextAlign, titleColor,
            contentFontFamily, contentFontSize, contentFontWeight, contentTextAlign, contentColor,
            listFontFamily, listFontSize, listFontWeight, listTextAlign, listColor].forEach(element => {
                element.addEventListener('input', () => {
                    if (currentSlideIndex >= 0) {
                        updateSlide();
                    }
                });
            });

        // Auto-update preview when form changes
        [slideTitle, slideContent, slideBackground, mediaUrl, mediaAlt].forEach(element => {
            element.addEventListener('input', () => {
                if (currentSlideIndex >= 0) {
                    updateSlide();
                }
            });
        });

        // Initialize
        loadSlides();
        setupFileUpload();
        setupPreviewControls();
        setupZoomControls();
        updateZoomDisplay();
    </script>
</body>

</html>